<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üìö ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶á‡¶Ø‡¶º‡ßá‡¶∞ ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø</title>
  
  <!-- Font Awesome CDN -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .dropdown {
      position: relative;
    }
    .dropdown-content {
      position: absolute;
      z-index: 10;
      background-color: white;
      border: 1px solid #15803D;
      border-radius: 0.75rem;
      width: 100%;
      max-height: 250px;
      overflow-y: auto;
      display: none;
      margin-top: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      scrollbar-width: thin;
      scrollbar-color: #15803D #E2E8F0;
    }
    .dropdown-content::-webkit-scrollbar {
      width: 8px;
    }
    .dropdown-content::-webkit-scrollbar-track {
      background: #F0FDF4;
      border-radius: 0.75rem;
    }
    .dropdown-content::-webkit-scrollbar-thumb {
      background-color: #15803D;
      border-radius: 0.75rem;
      border: 2px solid #F0FDF4;
    }
    .dropdown-content.active {
      display: block;
      animation: slideDown 0.2s ease-out;
    }
    .dropdown-content div {
      padding: 10px 16px;
      cursor: pointer;
      color: #15803D;
      font-weight: 600;
      transition: all 0.2s ease;
      border-bottom: 1px solid #DCFCE7;
    }
    .dropdown-content div:last-child {
      border-bottom: none;
    }
    .dropdown-content div:hover {
      background-color: #F0FDF4;
      padding-left: 20px;
    }
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    input:not(:placeholder-shown), input:focus {
      border-color: #22c55e; /* green-500 */
      border-width: 2px;
      --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
      --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
      box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
      --tw-ring-color: rgb(34 197 94 / 0.5);
      --tw-ring-opacity: 0.5;
    }
    /* Ensure consistent text color for all filter inputs */
    #categoryInput, #authorInput, #publisherInput {
      color: #15803d !important; /* green-700 */
    }
    /* Base styles for all filter inputs */
    .filter-input {
      color: #15803d !important;
      border-color: #86efac;
    }
    /* Specific styles for publisher input */
    #publisherInput {
      color: #15803d !important;
    }

    /* Clear button styles */
    .clear-btn {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #15803d;
      cursor: pointer;
      font-size: 18px;
      display: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f0fdf4;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .clear-btn:hover {
      background: #dcfce7;
    }

    input:not(:placeholder-shown) + .clear-btn {
      display: flex;
    }

  </style>
</head>
<body class="bg-gray-50">

<!-- Top Bar -->
<div class="fixed top-0 right-0 left-0 z-50 bg-green-800 text-white text-sm py-2">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
    <div class="flex items-center gap-2">
      <span><i class="fa-solid fa-feather-pointed text-green-600 mr-2"></i>‡¶Ü‡¶∏‡ßÅ‡¶® ‡¶Ö‡¶®‡ßç‡¶§‡¶∞‡¶ï‡ßá ‡¶™‡¶∞‡¶ø‡¶∂‡ßÅ‡¶¶‡ßç‡¶ß ‡¶ï‡¶∞‡¶ø</span>
    </div>
    <div class="flex gap-3">
      <a href="#" class="hover:text-green-300"><i class="fab fa-facebook-f"></i></a>
      <a href="#" class="hover:text-green-300"><i class="fab fa-youtube"></i></a>
      <a href="#" class="hover:text-green-300"><i class="fab fa-telegram"></i></a>
    </div>
  </div>
</div>

<!-- Navigation Bar -->
<header class="sticky top-8 z-50 bg-white shadow-md border-b border-green-100">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      
      <!-- Logo & Site Title -->
      <a href="index.html" class="flex items-center gap-2 px-4 py-2 bg-green-100 hover:bg-green-200 text-green-800 font-bold rounded-xl shadow shadow-green-300 transition duration-200">
        <i class="fa-solid fa-mosque text-green-600 text-lg"></i>
        <span class="text-lg">‡¶á‡¶∏‡¶≤‡¶æ‡¶π‡ßÄ ‡¶Æ‡ßÅ‡¶ú‡¶æ‡¶ï‡¶æ‡¶∞‡¶æ</span>
      </a>
      
      <!-- Desktop Menu -->
      <nav class="hidden md:flex items-center gap-4 text-green-800 font-semibold text-sm bg-white px-4 py-2 rounded-xl shadow border border-green-100">
        <a href="index.html" class="px-3 py-1 rounded hover:bg-green-100 transition">‡¶π‡ßã‡¶Æ</a>
        <a href="quran.html" class="px-3 py-1 rounded hover:bg-green-100 transition">‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®</a>
        <a href="book.html" class="px-3 py-1 rounded bg-green-100 transition">‡¶¨‡¶á</a>
        <a href="audio.html" class="px-3 py-1 rounded hover:bg-green-100 transition">‡¶Ö‡¶°‡¶ø‡¶ì</a>
        <a href="article.html" class="px-3 py-1 rounded hover:bg-green-100 transition">‡¶™‡ßç‡¶∞‡¶¨‡¶®‡ßç‡¶ß</a>
        <a href="contact.html" class="px-3 py-1 rounded hover:bg-green-100 transition">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a>
      </nav>
      
      <!-- Mobile Menu Button -->
      <div class="md:hidden">
        <button id="menuToggle" class="text-green-700 text-2xl focus:outline-none">
          <i class="fa-solid fa-bars"></i>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Mobile Dropdown Menu -->
  <div id="mobileMenu" class="md:hidden hidden bg-green-50 px-4 pb-4 rounded-b-xl shadow border-t border-green-100">
    <a href="index.html" class="block py-2 px-2 rounded hover:bg-green-100 text-green-800 font-semibold">‡¶π‡ßã‡¶Æ</a>
    <a href="quran.html" class="block py-2 px-2 rounded hover:bg-green-100 text-green-800 font-semibold">‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®</a>
    <a href="book.html" class="block py-2 px-2 rounded bg-green-100 text-green-800 font-semibold">‡¶¨‡¶á</a>
    <a href="audio.html" class="block py-2 px-2 rounded hover:bg-green-100 text-green-800 font-semibold">‡¶Ö‡¶°‡¶ø‡¶ì</a>
    <a href="article" class="block py-2 px-2 rounded hover:bg-green-100 text-green-800 font-semibold">‡¶™‡ßç‡¶∞‡¶¨‡¶®‡ßç‡¶ß</a>
    <a href="contact.html" class="block py-2 px-2 rounded hover:bg-green-100 text-green-800 font-semibold">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a>
  </div>
</header>

<section class="bg-gradient-to-br from-green-100 to-green-50 py-10 px-4 md:px-10 rounded-b-xl shadow-sm">
    <div class="max-w-7xl mx-auto">
   
   <div class="bg-white rounded-xl shadow-lg px-4 sm:px-6 md:px-8 lg:px-8 py-8 border border-green-200 mt-10">
      <div class="text-center mb-10">
        <h2 class="inline-block text-3xl sm:text-4xl font-bold px-8 py-4 rounded-xl bg-gradient-to-r from-green-100 via-green-50 to-green-100 shadow-md border-l-4 border-r-4 border-green-500 text-green-700" style="font-family: 'Charu Chandan', sans-serif;">
        ‡¶¨‡¶á ‡¶™‡¶°‡¶º‡ßÅ‡¶®
          <i class="fa-solid fa-book-open animate-pulse text-green-600 ml-2"></i>
        </h2>
      </div>

      <!-- Search Row -->
      <div class="mb-6">
        <label for="bookSearch" class="block text-green-700 font-semibold mb-2 text-center text-lg">
          <i class="fas fa-search text-green-600 mr-2"></i>‡¶¨‡¶á ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®
        </label>
        <div class="dropdown relative">
          <input
            type="text"
            id="bookSearch"
            placeholder="üìò ‡¶¨‡¶á‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."
            class="filter-input w-full px-4 py-3 border-2 border-green-300 rounded-xl outline-none shadow-sm placeholder:text-green-700 font-semibold placeholder:font-normal text-green-700 transition-all duration-200"
          />
          <div class="clear-btn" onclick="clearBookSearch()">√ó</div>
          <div id="bookSuggestions" class="dropdown-content"></div>
        </div>
      </div>

      <!-- Filters Row -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10">
        <div class="dropdown relative">
          <input id="categoryInput" type="text" placeholder="‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø..." 
            class="filter-input w-full px-4 py-2 border-2 border-green-300 rounded-xl outline-none shadow-sm placeholder:text-green-700 font-semibold placeholder:font-normal text-green-700 transition-all duration-200"
          />
          <div class="clear-btn" onclick="clearFilter('categoryInput')">√ó</div>
          <div id="categoryDropdown" class="dropdown-content"></div>
        </div>
        <div class="dropdown relative">
          <input id="authorInput" type="text" placeholder="‡¶≤‡ßá‡¶ñ‡¶ï..." 
            class="filter-input w-full px-4 py-2 border-2 border-green-300 rounded-xl outline-none shadow-sm placeholder:text-green-700 font-semibold placeholder:font-normal text-green-700 transition-all duration-200"
          />
          <div class="clear-btn" onclick="clearFilter('authorInput')">√ó</div>
          <div id="authorDropdown" class="dropdown-content"></div>
        </div>
        <div class="dropdown relative">
          <input id="publisherInput" type="text" placeholder="‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂‡¶®‡ßÄ..." 
            class="filter-input w-full px-4 py-2 border-2 border-green-300 rounded-xl outline-none shadow-sm placeholder:text-green-700 font-semibold placeholder:font-normal text-green-700 transition-all duration-200"
          />
          <div class="clear-btn" onclick="clearFilter('publisherInput')">√ó</div>
          <div id="publisherDropdown" class="dropdown-content"></div>
        </div>
      </div>

      <div class="flex justify-center mb-6">
        <button id="toggleAllBtn" class="px-6 py-2 bg-green-600 text-white rounded-xl text-center hover:bg-green-700 transition duration-200 shadow-md">
          ‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¨‡¶á ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
        </button>
      </div>

      <h2 id="categoryHeading" class="text-xl font-bold text-center mb-4"></h2>

      <div id="book-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>

      <div id="pagination" class="mt-8 flex justify-center overflow-x-auto gap-2"></div>
    </div>
  </div>
</section>

<!-- PDF Modal -->
<div id="pdfModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 p-4 md:p-0 hidden">
  <div class="relative bg-white w-full max-w-3xl rounded-2xl shadow-2xl overflow-hidden flex flex-col" style="height: 90vh;">
    
    <!-- Close Button -->
    <button onclick="closePdfModal()" class="absolute top-3 right-3 text-white bg-red-500 hover:bg-red-600 rounded-full w-8 h-8 flex items-center justify-center shadow-md transition duration-300 ease-in-out z-10">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Title & Author -->
    <div class="bg-white py-3 px-4 border-b border-gray-200">
      <h2 id="pdfBookTitle" class="text-lg md:text-xl font-semibold text-green-800 text-center">üìñ ‡¶¨‡¶á ‡¶™‡¶°‡¶º‡¶æ ‡¶ö‡¶≤‡¶õ‡ßá</h2>
      <p id="pdfBookAuthor" class="text-sm text-gray-600 text-center"></p>
    </div>

    <!-- PDF Viewer -->
    <div class="flex-1 w-full">
    <iframe
      id="pdfViewer"
      src=""
        class="w-full h-full rounded-b-lg"
      allowfullscreen
      loading="lazy"
    ></iframe>
    </div>
  </div>
</div>



<footer class="bg-gradient-to-b from-white to-green-50 border-t border-green-200 text-green-900 pt-14 ">
  <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10">
    
    <!-- About -->
    <div>
      <h3 class="text-xl font-bold mb-4 border-l-4 border-green-600 pl-3">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá</h3>
      <p class="text-[15px] text-green-800 leading-relaxed">
        ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®, ‡¶π‡¶æ‡¶¶‡¶ø‡¶∏, ‡¶∏‡ßÄ‡¶∞‡¶æ‡¶§, ‡¶¨‡¶á, ‡¶Ö‡¶°‡¶ø‡¶ì ‡¶ì ‡¶™‡ßç‡¶∞‡¶¨‡¶®‡ßç‡¶ß‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶õ‡ßú‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶§‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡¶ø‡•§
        ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶õ‡¶ø ‡¶∏‡¶§‡ßç‡¶Ø‡ßá‡¶∞ ‡¶Ü‡¶≤‡ßã ‡¶™‡ßå‡¶Å‡¶õ‡ßá ‡¶¶‡¶ø‡¶§‡ßá‡•§
      </p>
    </div>
    
    <!-- Quick Links -->
    <div>
      <h3 class="text-xl font-bold mb-4 border-l-4 border-green-600 pl-3">‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶≤‡¶ø‡¶Ç‡¶ï</h3>
      <ul class="space-y-2 text-[15px]">
        <li><a href="#" class="flex items-center gap-2 hover:text-green-700 transition"><i class="fa-solid fa-book-open-reader"></i> ‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® ‡¶ì ‡¶§‡¶æ‡¶´‡¶∏‡ßÄ‡¶∞</a></li>
        <li><a href="#" class="flex items-center gap-2 hover:text-green-700 transition"><i class="fa-solid fa-book"></i> ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶¨‡¶á</a></li>
        <li><a href="#" class="flex items-center gap-2 hover:text-green-700 transition"><i class="fa-solid fa-mosque"></i> ‡¶∏‡ßÄ‡¶∞‡¶æ‡¶§ ‡¶ì ‡¶∏‡ßÅ‡¶®‡ßç‡¶®‡¶æ‡¶π</a></li>
        <li><a href="#" class="flex items-center gap-2 hover:text-green-700 transition"><i class="fa-solid fa-pen-nib"></i> ‡¶™‡ßç‡¶∞‡¶¨‡¶®‡ßç‡¶ß</a></li>
      </ul>
    </div>
    
    <!-- Contact -->
    <div>
      <h3 class="text-xl font-bold mb-4 border-l-4 border-green-600 pl-3">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h3>
      <p class="text-[15px]"><i class="fa-solid fa-envelope text-green-600 mr-2"></i> <a href="mailto:info@example.com" class="hover:underline">info@example.com</a></p>
      <p class="text-[15px] mt-2"><i class="fa-brands fa-facebook text-green-600 mr-2"></i> <a href="#" class="hover:underline">fb.com/yourpage</a></p>
    </div>
    
    <!-- Subscribe -->
    <div>
      <h3 class="text-xl font-bold mb-4 border-l-4 border-green-600 pl-3">‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶™‡ßá‡¶§‡ßá</h3>
      <form class="flex flex-col sm:flex-row gap-3">
        <input type="email" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="w-full px-4 py-2 rounded-md border border-green-300 focus:outline-none focus:ring-2 focus:ring-green-400 bg-white text-green-800" />
        <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition font-medium">‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶æ‡¶á‡¶¨</button>
      </form>
    </div>
  </div>
  
  <!-- Divider Ornament -->
  <div class="mt-10 flex justify-center">
    <svg class="w-40 h-6 text-green-400" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 172 28">
      <path stroke-linecap="round" stroke-linejoin="round" d="M1 14h20M30 14h20M59 14h20M88 14h20M117 14h20M146 14h25" />
    </svg>
  </div>
  
  <!-- Bottom Copyright -->
  <div class="text-center text-sm text-green-600 py-6 mt-4 border-t border-green-100">
    &copy; ‡ß®‡ß¶‡ß®‡ß´ <span class="font-semibold">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶®‡¶æ‡¶Æ</span> | ‡¶∏‡¶∞‡ßç‡¶¨‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡•§
  </div>
</footer>  
  








<script>
  // Global Variables & State Management
  let booksData = []; // Stores all books from books.json
  let selected = { title: '', category: '', author: '', publisher: '' }; // Tracks selected filters
  let isShowingAll = false;
  let currentPage = 1;
  const booksPerPage = 12;

  // Store unique values for filtering
  const uniqueValues = {
    categories: new Set(),
    authors: new Set(),
    publishers: new Set(),
    titles: new Set()
  };

  /**
   * Process book data to extract unique values for filtering
   * @param {Array} data - Array of book objects from books.json
   */
  function processUniqueValues(data) {
    data.forEach(book => {
      // Extract Bengali title if available
      if (book.title && book.title.bn) {
        uniqueValues.titles.add(book.title.bn);
      }
      // Extract Bengali category if available
      if (book.category && book.category.bn) {
        uniqueValues.categories.add(book.category.bn);
      }
      // Extract Bengali author if available
      if (book.author && book.author.bn) {
        uniqueValues.authors.add(book.author.bn);
      }
      // Extract Bengali publisher if available
      if (book.publisher && book.publisher.bn) {
        uniqueValues.publishers.add(book.publisher.bn);
      }
    });
  }

  /**
   * Fetch books data from books.json and initialize the application
   */
  async function initializeBooks() {
    try {
      const response = await fetch('books.json');
      if (!response.ok) {
        throw new Error('Failed to fetch books data');
      }
      
      booksData = await response.json();
      
      // Process the data for filtering
      processUniqueValues(booksData);
      
      // Set up event listeners for filters
      attachInputEvents('categoryInput', 'categoryDropdown', 'categories');
      attachInputEvents('authorInput', 'authorDropdown', 'authors');
      attachInputEvents('publisherInput', 'publisherDropdown', 'publishers');
      
      // Set up search functionality
      setupSearch();
      
      // Check for URL parameters
      const categoryParam = getQueryParam('category');
      if (categoryParam) {
        selected.category = categoryParam;
        document.getElementById('categoryInput').value = categoryParam;
        updateFilters();
      }
      
    } catch (error) {
      console.error('Error loading books:', error);
      // Show error message to user
      document.getElementById('book-list').innerHTML = `
        <div class="col-span-full text-center text-red-600 p-4">
          <p>‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶¨‡¶á‡¶Ø‡¶º‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßá‡¶ú‡¶ü‡¶ø ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
        </div>
      `;
    }
  }

  /**
   * Set up search functionality with suggestions
   */
  function setupSearch() {
    const searchInput = document.getElementById("bookSearch");
    const suggestionsBox = document.getElementById("bookSuggestions");
    
    searchInput.addEventListener("input", () => {
      const searchQuery = searchInput.value.trim().toLowerCase();
      suggestionsBox.classList.add("active");
      
      // Filter books based on search query
      let filteredBooks = booksData;
      if (searchQuery) {
        filteredBooks = booksData.filter(book => 
          book.title.bn.toLowerCase().includes(searchQuery) ||
          book.title.en.toLowerCase().includes(searchQuery) ||
          book.author.bn.toLowerCase().includes(searchQuery) ||
          book.category.bn.toLowerCase().includes(searchQuery)
        );
      }
      
      updateBookDropdown(filteredBooks);
    });
    
    searchInput.addEventListener("focus", () => {
      suggestionsBox.classList.add("active");
      updateBookDropdown(booksData);
    });
    
    searchInput.addEventListener("blur", () => {
      setTimeout(() => suggestionsBox.classList.remove("active"), 200);
    });

    // Add keyboard navigation
    searchInput.addEventListener('keydown', (e) => {
      const items = suggestionsBox.querySelectorAll('div.cursor-pointer');
      const currentIndex = Array.from(items).findIndex(item => item.classList.contains('bg-gray-100'));
      
      switch(e.key) {
        case 'ArrowDown':
          e.preventDefault();
          if (currentIndex < items.length - 1) {
            items[currentIndex]?.classList.remove('bg-gray-100');
            items[currentIndex + 1]?.classList.add('bg-gray-100');
            items[currentIndex + 1]?.scrollIntoView({ block: 'nearest' });
          }
          break;
        case 'ArrowUp':
          e.preventDefault();
          if (currentIndex > 0) {
            items[currentIndex]?.classList.remove('bg-gray-100');
            items[currentIndex - 1]?.classList.add('bg-gray-100');
            items[currentIndex - 1]?.scrollIntoView({ block: 'nearest' });
          }
          break;
        case 'Enter':
          e.preventDefault();
          const selectedItem = items[currentIndex];
          if (selectedItem) {
            const bookTitle = selectedItem.querySelector('.font-semibold').textContent;
            searchInput.value = bookTitle;
            updateFilters();
            suggestionsBox.classList.remove("active");
          }
          break;
        case 'Escape':
          suggestionsBox.classList.remove("active");
          searchInput.blur();
          break;
      }
    });
  }

  function updateBookDropdown(filteredBooks) {
    const dropdown = document.getElementById("bookSuggestions");
    const searchInput = document.getElementById("bookSearch");
    const searchQuery = searchInput.value.trim().toLowerCase();
    
    dropdown.innerHTML = '';
    
    if (filteredBooks.length === 0) {
      const div = document.createElement("div");
      div.innerHTML = `<div class="px-2 py-1 text-gray-500 text-center">‡¶ï‡ßã‡¶® ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</div>`;
      dropdown.appendChild(div);
      return;
    }

    filteredBooks.forEach(book => {
      const div = document.createElement("div");
      div.innerHTML = `
        <div class="flex flex-col">
          <span class="font-semibold">${book.title.bn} (${book.title.en})</span>
          <span class="text-sm text-gray-600">
            <i class="fa-solid fa-pen-nib text-green-500 mr-1"></i>${book.author.bn}
            <span class="mx-1">‚Ä¢</span>
            <i class="fas fa-folder-open text-green-500 mr-1"></i>${book.category.bn}
          </span>
        </div>`;
      div.classList.add('cursor-pointer', 'px-2', 'py-1', 'hover:bg-gray-100');
      
      div.addEventListener('mousedown', () => {
        searchInput.value = `${book.title.bn} (${book.title.en})`;
        updateFilters();
        dropdown.classList.remove("active");
      });
      dropdown.appendChild(div);
    });
  }

  function updateFilters() {
    if (!isShowingAll && !selected.category && !selected.author && !selected.publisher && !document.getElementById("bookSearch").value.trim()) {
      renderBooks([]);
      document.getElementById("pagination").innerHTML = "";
      return;
    }

    let filteredBooks = [...booksData];

    // Apply search filter
    const searchQuery = document.getElementById("bookSearch").value.trim().toLowerCase();
    if (searchQuery) {
      filteredBooks = filteredBooks.filter(book => {
        const fullTitle = `${book.title.bn} (${book.title.en})`.toLowerCase();
        const searchLower = searchQuery.toLowerCase();
        return fullTitle === searchLower || // Exact match for full title
               book.title.bn.toLowerCase().includes(searchLower) ||
               book.title.en.toLowerCase().includes(searchLower) ||
               book.author.bn.toLowerCase().includes(searchLower) ||
               book.category.bn.toLowerCase().includes(searchLower);
      });
    }

    // Apply other filters
    if (selected.category) {
      filteredBooks = filteredBooks.filter(book => book.category.bn === selected.category);
    }
    if (selected.author) {
      filteredBooks = filteredBooks.filter(book => book.author.bn === selected.author);
    }
    if (selected.publisher) {
      filteredBooks = filteredBooks.filter(book => book.publisher.bn === selected.publisher);
    }

    // Reset to first page when filters change
    currentPage = 1;
    paginateBooks(filteredBooks);
  }

  function updateDropdown(inputId, dropdownId, items) {
    const dropdown = document.getElementById(dropdownId);
    const input = document.getElementById(inputId);
    const inputValue = input.value.toLowerCase();
    
    dropdown.innerHTML = '';
    
    if (items.length === 0) {
      const div = document.createElement('div');
      div.textContent = '‡¶ï‡ßã‡¶® ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø';
      div.classList.add('px-2', 'py-1', 'text-gray-500', 'text-center');
      dropdown.appendChild(div);
      return;
    }

    const filteredItems = inputValue ? 
      items.filter(item => item.toLowerCase().includes(inputValue)) : 
      items;

    filteredItems.sort((a, b) => a.localeCompare(b, 'bn'));

    filteredItems.forEach(item => {
      const div = document.createElement('div');
      // Find the corresponding English text from booksData
      const bookWithItem = booksData.find(book => {
        switch(inputId) {
          case 'categoryInput': return book.category.bn === item;
          case 'authorInput': return book.author.bn === item;
          case 'publisherInput': return book.publisher.bn === item;
          default: return false;
        }
      });
      
      if (bookWithItem) {
        const enText = inputId === 'categoryInput' ? bookWithItem.category.en :
                      inputId === 'authorInput' ? bookWithItem.author.en :
                      bookWithItem.publisher.en;
        div.textContent = `${item} (${enText})`;
      } else {
        div.textContent = item;
      }

      div.classList.add('cursor-pointer', 'px-2', 'py-1', 'hover:bg-gray-100');
      
      if (selected[inputId.replace('Input', '')] === item) {
        div.classList.add('bg-green-50');
      }
      
      div.addEventListener('mousedown', () => {
        const displayText = div.textContent;
        input.value = displayText;
        selected[inputId.replace('Input', '')] = item; // Keep storing just the Bengali text in selected
        updateFilters();
        dropdown.classList.remove('active');
      });
      dropdown.appendChild(div);
    });
  }

  function attachInputEvents(inputId, dropdownId, type) {
    const input = document.getElementById(inputId);
    const dropdown = document.getElementById(dropdownId);
    
    input.addEventListener('input', () => {
      // Get currently filtered books based on other selections
      let availableItems = [...booksData];
      
      if (selected.category && type !== 'categories') {
        availableItems = availableItems.filter(book => book.category.bn === selected.category);
      }
      if (selected.author && type !== 'authors') {
        availableItems = availableItems.filter(book => book.author.bn === selected.author);
      }
      if (selected.publisher && type !== 'publishers') {
        availableItems = availableItems.filter(book => book.publisher.bn === selected.publisher);
      }

      // Extract unique values for this filter type
      const items = new Set(availableItems.map(book => {
        switch(type) {
          case 'categories': return book.category.bn;
          case 'authors': return book.author.bn;
          case 'publishers': return book.publisher.bn;
          default: return '';
        }
      }));

      updateDropdown(inputId, dropdownId, Array.from(items));
      dropdown.classList.add('active');
    });
    
    input.addEventListener('focus', () => {
      // Same logic as input event
      let availableItems = [...booksData];
      
      if (selected.category && type !== 'categories') {
        availableItems = availableItems.filter(book => book.category.bn === selected.category);
      }
      if (selected.author && type !== 'authors') {
        availableItems = availableItems.filter(book => book.author.bn === selected.author);
      }
      if (selected.publisher && type !== 'publishers') {
        availableItems = availableItems.filter(book => book.publisher.bn === selected.publisher);
      }

      const items = new Set(availableItems.map(book => {
        switch(type) {
          case 'categories': return book.category.bn;
          case 'authors': return book.author.bn;
          case 'publishers': return book.publisher.bn;
          default: return '';
        }
      }));

      updateDropdown(inputId, dropdownId, Array.from(items));
      dropdown.classList.add('active');
    });
    
    input.addEventListener('blur', () => {
      setTimeout(() => dropdown.classList.remove('active'), 200);
    });
  }

  function clearBookSearch() {
    const searchInput = document.getElementById("bookSearch");
    searchInput.value = '';
    updateFilters();
  }

  // Toggle all books button
  document.getElementById("toggleAllBtn").addEventListener("click", () => {
    const btn = document.getElementById("toggleAllBtn");
    if (!isShowingAll) {
      isShowingAll = true;
      selected = { title: '', category: '', author: '', publisher: '' };
      document.getElementById("categoryInput").value = '';
      document.getElementById("authorInput").value = '';
      document.getElementById("publisherInput").value = '';
      document.getElementById("bookSearch").value = '';
      btn.textContent = "‡¶¨‡¶á ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®";
      paginateBooks(booksData);
    } else {
      isShowingAll = false;
      btn.textContent = "‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¨‡¶á ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®";
      renderBooks([]);
      document.getElementById("pagination").innerHTML = "";
    }
  });

  // Initialize the application when the page loads
  document.addEventListener('DOMContentLoaded', function() {
    // Get category from URL if it exists
    const urlParams = new URLSearchParams(window.location.search);
    const categoryParam = urlParams.get('category');

    // Load initial data
    fetch('books.json')
      .then(res => res.json())
      .then(data => {
        booksData = data;
        processUniqueValues(data);
        
        // Set up filters
        attachInputEvents('categoryInput', 'categoryDropdown', 'categories');
        attachInputEvents('authorInput', 'authorDropdown', 'authors');
        attachInputEvents('publisherInput', 'publisherDropdown', 'publishers');
        setupSearch();

        // If category parameter exists, select it
        if (categoryParam) {
          // Find the matching Bengali category name
          const matchingBook = booksData.find(book => 
            book.category.en.toLowerCase() === categoryParam.toLowerCase() ||
            book.category.bn === categoryParam
          );

          if (matchingBook) {
            selected.category = matchingBook.category.bn;
            document.getElementById('categoryInput').value = `${matchingBook.category.bn} (${matchingBook.category.en})`;
            isShowingAll = true; // Ensure books are shown
            updateFilters();
          }
        }
      });
  });

  // Render books in a grid
  function renderBooks(books) {
    const container = document.getElementById('book-list');
    container.innerHTML = '';
    
    books.forEach(book => {
      container.innerHTML += `
        <div class="bg-white rounded-2xl shadow-md p-5 border border-gray-200 transition hover:shadow-lg text-center flex flex-col justify-between">
          <img src="${book.cover}" alt="cover" class="w-48 mx-auto h-72 object-cover rounded-lg mb-5">
          <h2 class="text-xl font-semibold mb-1 text-green-700">${book.title.bn}</h2>
          <p><i class="text-green-500 fa-solid fa-square-pen"></i> ‡¶≤‡ßá‡¶ñ‡¶ï: ${book.author.bn}</p>
          <p><i class="fas fa-folder-open text-green-500"></i> ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø: ${book.category.bn}</p>
          <p><i class="fas fa-building text-green-600"></i> ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂‡¶®‡ßÄ: ${book.publisher.bn}</p>
          <div class="mt-3 justify-center flex gap-2">
            <a href="#" onclick="openPdfModal('${book.read_url}')" class="px-3 py-1 bg-green-600 text-white rounded">
              <i class="fa-solid fa-book-open mr-1"></i> ‡¶™‡¶°‡¶º‡ßÅ‡¶®
            </a>
            <a href="${book.download_url}" target="_blank" class="px-3 py-1 bg-blue-600 text-white rounded">‚¨áÔ∏è ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</a>
          </div>
        </div>
      `;
    });
  }

  // PDF Modal Management
  function openPdfModal(readUrl) {
    const modal = document.getElementById("pdfModal");
    const viewer = document.getElementById("pdfViewer");
    if (readUrl) {
      viewer.src = readUrl;
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  }
  
  function closePdfModal() {
    const modal = document.getElementById("pdfModal");
    const viewer = document.getElementById("pdfViewer");
    viewer.src = "";
    modal.classList.add('hidden');
    document.body.style.overflow = 'auto';
  }

  // Pagination Management
  function paginateBooks(books) {
    if (!books || books.length === 0) {
      renderBooks([]);
      document.getElementById("pagination").innerHTML = "";
      return;
    }

    const totalPages = Math.ceil(books.length / booksPerPage);
    const start = (currentPage - 1) * booksPerPage;
    const end = Math.min(start + booksPerPage, books.length);
    const paginatedBooks = books.slice(start, end);
    
    renderBooks(paginatedBooks);
    renderPaginationButtons(books.length);
  }
  
  function renderPaginationButtons(totalBooks) {
    const pagination = document.getElementById("pagination");
    pagination.innerHTML = "";
    
    const totalPages = Math.ceil(totalBooks / booksPerPage);
    if (totalPages <= 1) return;
    
    // Previous button
    const prevBtn = document.createElement("button");
    prevBtn.textContent = "¬´ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ";
    prevBtn.className = `px-3 py-1 border rounded text-sm ${
      currentPage === 1 
        ? "bg-gray-100 text-gray-400 cursor-not-allowed" 
        : "bg-white text-green-700 hover:bg-green-50"
    }`;
    prevBtn.disabled = currentPage === 1;
    prevBtn.addEventListener('click', function(e) {
      e.preventDefault();
      if (currentPage > 1) {
        currentPage--;
        let filteredBooks = getFilteredBooks();
        paginateBooks(filteredBooks);
      }
    });
    pagination.appendChild(prevBtn);
    
    // Page numbers
    let startPage = Math.max(1, currentPage - 2);
    let endPage = Math.min(startPage + 4, totalPages);
    
    if (endPage - startPage < 4) {
      startPage = Math.max(1, endPage - 4);
    }
    
    for (let i = startPage; i <= endPage; i++) {
      const btn = document.createElement("button");
      btn.textContent = i;
      btn.className = `px-3 py-1 border rounded text-sm ${
        i === currentPage 
          ? "bg-green-600 text-white" 
          : "bg-white text-green-700 hover:bg-green-50"
      }`;
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        currentPage = i;
        let filteredBooks = getFilteredBooks();
        paginateBooks(filteredBooks);
      });
      pagination.appendChild(btn);
    }
    
    // Next button
    const nextBtn = document.createElement("button");
    nextBtn.textContent = "‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ¬ª";
    nextBtn.className = `px-3 py-1 border rounded text-sm ${
      currentPage === totalPages 
        ? "bg-gray-100 text-gray-400 cursor-not-allowed" 
        : "bg-white text-green-700 hover:bg-green-50"
    }`;
    nextBtn.disabled = currentPage === totalPages;
    nextBtn.addEventListener('click', function(e) {
      e.preventDefault();
      if (currentPage < totalPages) {
        currentPage++;
        let filteredBooks = getFilteredBooks();
        paginateBooks(filteredBooks);
      }
    });
    pagination.appendChild(nextBtn);
  }

  // Helper function to get filtered books
  function getFilteredBooks() {
    let filteredBooks = [...booksData];

    const searchQuery = document.getElementById("bookSearch").value.trim().toLowerCase();
    if (searchQuery) {
      filteredBooks = filteredBooks.filter(book => 
        book.title.bn.toLowerCase().includes(searchQuery) ||
        book.title.en.toLowerCase().includes(searchQuery) ||
        book.author.bn.toLowerCase().includes(searchQuery) ||
        book.category.bn.toLowerCase().includes(searchQuery)
      );
    }

    if (selected.category) {
      filteredBooks = filteredBooks.filter(book => book.category.bn === selected.category);
    }
    if (selected.author) {
      filteredBooks = filteredBooks.filter(book => book.author.bn === selected.author);
    }
    if (selected.publisher) {
      filteredBooks = filteredBooks.filter(book => book.publisher.bn === selected.publisher);
    }

    return filteredBooks;
  }

  // Mobile menu toggle
  document.getElementById('menuToggle').addEventListener('click', function() {
    document.getElementById('mobileMenu').classList.toggle('hidden');
  });

  // Close mobile menu when clicking outside
  document.addEventListener('click', function(e) {
    const mobileMenu = document.getElementById('mobileMenu');
    const menuToggle = document.getElementById('menuToggle');
    
    if (!menuToggle.contains(e.target) && !mobileMenu.contains(e.target)) {
      mobileMenu.classList.add('hidden');
    }
   
   
  });

  // Close modal when clicking outside
  document.getElementById('pdfModal').addEventListener('click', function(e) {
    if (e.target === this) {
      closePdfModal();
    }
  });

  // Clear filter function
  function clearFilter(inputId) {
    const input = document.getElementById(inputId);
    input.value = '';
    selected[inputId.replace('Input', '')] = '';
    updateFilters();
  }
</script>

</body>
</html>